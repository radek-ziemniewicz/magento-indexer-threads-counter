(function(e){function t(t){for(var r,s,c=t[0],l=t[1],a=t[2],u=0,b=[];u<c.length;u++)s=c[u],Object.prototype.hasOwnProperty.call(o,s)&&o[s]&&b.push(o[s][0]),o[s]=0;for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(e[r]=l[r]);d&&d(t);while(b.length)b.shift()();return i.push.apply(i,a||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],r=!0,c=1;c<n.length;c++){var l=n[c];0!==o[l]&&(r=!1)}r&&(i.splice(t--,1),e=s(s.s=n[0]))}return e}var r={},o={app:0},i=[];function s(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=r,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)s.d(n,r,function(t){return e[t]}.bind(null,r));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/magento-parallel-indexing/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],l=c.push.bind(c);c.push=t,c=c.slice();for(var a=0;a<c.length;a++)t(c[a]);var d=l;i.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("7a23");function o(e,t,n,o,i,s){var c=Object(r["f"])("Calculate");return Object(r["e"])(),Object(r["b"])(c)}var i=Object(r["d"])("div",{class:"docs"},[Object(r["d"])("h1",null,[Object(r["d"])("strong",null,"Disclaimer")]),Object(r["d"])("p",null," Parallel indexing creates several tables to be used in parallel, in some cases this might causes some side effects such as slowness on DB, that said, we don’t suggest this for merchants with small catalog. "),Object(r["d"])("p",null," In general, if the full reindex takes over 30 min, then parallel indexing should be something to consider. "),Object(r["d"])("p",null," Just keep in mind that reindexing is considered a bad practice when performed manually in production, the cron should be enabled and running a complementary indexing each minute. "),Object(r["d"])("p",null,[Object(r["c"])(" Magento indexer threads counter based on:"),Object(r["d"])("br"),Object(r["d"])("a",{href:"https://devdocs.magento.com/guides/v2.2/config-guide/cli/config-cli-subcommands-index.html#config-cli-subcommands-index-reindex-parallel",target:"_blank"}," https://devdocs.magento.com/guides/v2.2/config-guide/cli/config-cli-subcommands-index.html#config-cli-subcommands-index-reindex-parallel "),Object(r["d"])("br"),Object(r["d"])("a",{href:"https://community.magento.com/t5/Magento-DevBlog/Indexers-parallelization-and-optimization/ba-p/104922",target:"_blank"}," https://community.magento.com/t5/Magento-DevBlog/Indexers-parallelization-and-optimization/ba-p/104922 ")])],-1),s={class:"input"},c=Object(r["d"])("label",{for:"websites"},"Websites",-1),l=Object(r["d"])("p",{class:"info font-mono"},"SELECT count(*)-1 FROM store_website;",-1),a={class:"input"},d=Object(r["d"])("label",{for:"customerGroups"},"Customer groups",-1),u=Object(r["d"])("p",{class:"info font-mono"},"SELECT count(*)-1 FROM customer_group;",-1),b={class:"input"},p=Object(r["d"])("label",{for:"threads"},[Object(r["c"])(" Your current number of threads "),Object(r["d"])("span",{class:"cursor-pointer",title:"For processors with Hyper-Threading Technology, 1 core has 2 threads"},"ℹ")],-1),m=Object(r["d"])("p",{class:"info font-mono"},"$ nproc",-1),h={key:0,class:"code"},f=Object(r["d"])("div",{class:"step"},[Object(r["d"])("p",null," First, set the dimension mode: "),Object(r["d"])("pre",null,"          $ bin/magento indexer:set-dimensions-mode catalog_product_price website\n        ")],-1),O={class:"step"},g=Object(r["d"])("p",null,[Object(r["c"])(" For cloud based instances, set the env variable in the "),Object(r["d"])("b",null,".magento.env.yaml"),Object(r["c"])(" file or In cloud UI: ")],-1),j=Object(r["d"])("p",null," If using in staging or integration environment: ",-1),v=Object(r["d"])("pre",null,"          $ bin/magento index:reindex\n        ",-1),x=Object(r["d"])("p",null," If using in production, stop the cron first and then reset and reindex index by index: ",-1),y=Object(r["d"])("pre",null,"          $ php vendor/bin/ece-tools cron:disable; php vendor/bin/ece-tools cron:kill; php vendor/bin/ece-tools cron:unlock; php bin/magento indexer:info | awk ‘{print $1}’ | xargs -I {} bash -c ‘php bin/magento indexer:reset {} && php bin/magento indexer:reindex {}’; php vendor/bin/ece-tools cron:enable\n        ",-1),w={class:"step"},_=Object(r["d"])("p",null,[Object(r["c"])(" For on premises instances, set the env variable in "),Object(r["d"])("b",null,"app/etc/env.php"),Object(r["c"])(" files: ")],-1),E=Object(r["d"])("p",null,[Object(r["d"])("b",null,"Important: If using in production, stop the cron first!")],-1),I={class:"step note"},k=Object(r["d"])("p",null," Just for testing purposes, you can use parallel indexing only once, see the example below: ",-1),G={key:1,class:"message"},M=Object(r["c"])(" You can't use the parallel indexer, because the number of websites times the number of customer groups is greater than the number of threads."),T=Object(r["d"])("br",null,null,-1);function $(e,t,n,o,$,D){return Object(r["e"])(),Object(r["b"])("main",null,[i,Object(r["d"])("div",s,[c,Object(r["i"])(Object(r["d"])("input",{id:"websites",name:"websites",type:"number",min:"1","onUpdate:modelValue":t[1]||(t[1]=function(e){return $.websites=e})},null,512),[[r["h"],$.websites]]),l]),Object(r["d"])("div",a,[d,Object(r["i"])(Object(r["d"])("input",{id:"customerGroups",name:"customerGroups",type:"number",min:"1","onUpdate:modelValue":t[2]||(t[2]=function(e){return $.customerGroups=e})},null,512),[[r["h"],$.customerGroups]]),u]),Object(r["d"])("div",b,[p,Object(r["i"])(Object(r["d"])("input",{id:"threads",name:"threads",type:"number",min:"1","onUpdate:modelValue":t[3]||(t[3]=function(e){return $.threads=e})},null,512),[[r["h"],$.threads]]),m]),D.result?(Object(r["e"])(),Object(r["b"])("div",h,[f,Object(r["d"])("div",O,[g,Object(r["d"])("pre",null,"          $ MAGE_INDEXER_THREADS_COUNT="+Object(r["g"])(D.result)+"\n        ",1),j,v,x,y]),Object(r["d"])("div",w,[_,Object(r["d"])("pre",null,"          $ MAGE_INDEXER_THREADS_COUNT="+Object(r["g"])(D.result)+"\n          $ bin/magento index:reindex\n        ",1),E]),Object(r["d"])("div",I,[k,Object(r["d"])("pre",null,"          $ bin/magento indexer:set-dimensions-mode catalog_product_price website\n          $ bin/magento indexer:reset catalogsearch_fulltext\n          $ php -d memory_limit=-1 MAGE_INDEXER_THREADS_COUNT="+Object(r["g"])(D.result)+" -f bin/magento indexer:reindex catalogsearch_fulltext\n          $ bin/magento indexer:set-dimensions-mode none\n        ",1)])])):(Object(r["e"])(),Object(r["b"])("div",G,[Object(r["d"])("p",null,[M,T,Object(r["c"])(" Required number of threads: "+Object(r["g"])(this.websites*this.customerGroups)+". ",1)])]))])}var D={name:"Calculate",data:function(){return{websites:2,customerGroups:1,threads:4}},computed:{result:function(){return this.websites*this.customerGroups<=this.threads?this.websites*this.customerGroups:0}}};n("bcc3");D.render=$;var S=D,C={name:"App",components:{Calculate:S}};C.render=o;var R=C,P=(n("def6"),Object(r["a"])(R));P.mount("#app")},"9e1f":function(e,t,n){},bcc3:function(e,t,n){"use strict";n("9e1f")},def6:function(e,t,n){}});
//# sourceMappingURL=app.aa11f165.js.map